#             深入理解计算机系统

## 第一章：计算机系统漫游

 当我们运行 hello.c 程序的时候，电脑在做什么？

程序的生命周期是从一个源程序开始的，源程序实际上就是一个由值0和1组成的位（比特）序列。

8个位一组，称为字节，每个字节表示程序中的某些文本字符。

**由 ASCII 字符构成的文件称为文本文件，所有其他文件称为二进制文件。**

c 语句 —> 低级机器语言指令 —> 按照**可执行目标程序**格式打包 —> 以**二进制磁盘文件**形式存放。

**编译系统——预处理器，编译器，汇编器，链接器**

**系统的硬件组织**

1. 总线：贯穿整个系统的一组电子管道。它负责携带信息字节并负责在各个部件间传递。通常总线被设计成传送定长的字节块，也就是字（Word）字中的字节数是一个基本的系统参数。4字节—32位，8字节—64位。

2. I/O 设备：系统与外界的联系通道。每个 I/O 设备都通过一个控制器或适配器与 I/O 总线相连。

3. 主存：临时存储设备，在处理器执行程序时，用来存放程序和程序处理的数据。

4. 处理器：中央处理单元，是解释（或执行）存储在主存中指令的引擎。处理器的核心是一个大小为一个字的存储设备（或寄存器），称为程序计数器（pc）。在任何时刻，pc都指向主存中的某条机器语言指令（即含有这条指令的地址）。

   **每个寄存器都有唯一的名字**

   CPU 在指令的要求下可能会执行这些操作。

   - 加载：从主存复制一个字节或者一个字到寄存器，以覆盖寄存器原来的内容。

   - 存储：从寄存器复制一个字节或者一个字到主存的某个位置，以覆盖这个位置上原来的内容。

   - 操作：把两个寄存器的内容复制到 ALU，ALU 对这两个字做算术运算，并将结果存放到一个寄存器中，以覆盖该寄存器中原来的内容。

   - 跳转：从指令本身中抽取一个字，并将这个字复制到 PC 中，以覆盖 PC 中原来的值。

    
**处理器的指令集架构：描述每条机器代码指令的效果**
   
**微体系结构：描述处理器实际是如何实现的**
     
**进程**：是操作系统对一个正在运行的程序的一种抽象。

**并发运行**：一个进程的指令和另一个进程的指令是交错执行。

**上下文切换**：一个CPU看上去都像是在并发地执行多个进程，这是通过处理器在进程间切换来实现的。（保存当前进程的上下文，恢复新进程的上下文）操作系统实现这种交错执行的机制称为上下文切换。

**上下文**：操作系统保持跟踪进程运行所需的所有状态信息。

**虚拟内存**：是一个抽象概念，它为每个进程提供了一个假象，即每个进程都在独占地使用主存。每个进程看到的内存都是一致的，称为虚拟地址空间。

### 进程的虚拟地址空间

- **程序代码和数据**：对所有的进程来说，代码是从同一固定地址开始，紧接着的是和C全局变量相对应的数据位置。进程一开始运行就被指定了大小。

- **堆**：堆可以在运行时动态地扩展和收缩。

- **共享库**：存放C标准库和数学库这样的共享库的代码和数据的区域。

- **栈**：用户栈在程序执行期间可以动态的扩展和收缩。调用一个函数时，栈就会增长；从一个函数返回的时候，栈就会收缩。

- **内核虚拟内存**：为内核保留。不允许应用程序读写这个区域的内容或者直接调用内核代码定义的函数，相反，它们必须调用内核来执行这些操作。
**文件**：文件就是字节序列。

     ​
